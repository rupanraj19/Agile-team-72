<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Home Page</title>
    <link rel="icon" href="/assets/logo.png" type="image/png" />
    <link rel="stylesheet" href="main.css">

</head>

<body>
    <!-- header -->
    <%- include('partials/header') %>
    <!-- header end -->
    <main>
        <section class="first-section">
                    <img src="assets/home.png" alt="you are not alone" class="img-fluid home">
        </section>

        <section class="second-section p-3">
            <div class="row">
                <div class="col-8">
                    <div class="container">
                        <h4 class="text-center mt-4">Activities Guidance</h4>
                        <div class="line1"></div>
                        <p class="text-center mt-4">These guided activities are designed to support your overall well-being and help you develop healthy habits</p>
                        <div class="d-flex justify-content-center mt-4">
                            <img class="p-2 left-img img-fluid" src="assets/art.png" alt="art" >
                            <img class="p-2 left-img img-fluid" src="assets/meditation.png" alt="meditation" data-bs-toggle="modal" data-bs-target="#meditationModal">
                            <img class="p-2 left-img img-fluid" src="assets/mindfulness.png" alt="mindfulness" data-bs-toggle="modal" data-bs-target="#mindfulnessModal">
                        </div>
                    </div>
                </div>
                <div class="col-4 p-4">
                    <img class="happy-img img-fluid" src="assets/behappy.png" alt="girl sitting alone" >
                </div>
            </div>
        </section>

        <!-- Meditation Modal -->
        <div class="modal fade" id="meditationModal" tabindex="-1" aria-labelledby="meditationModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-lg">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="meditationModalLabel">Guided Meditation</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <div class="ratio ratio-16x9">
                            <iframe src="https://www.youtube.com/embed/cyMxWXlX9sU" title="Guided Meditation" allowfullscreen></iframe>
                        </div>
                        <!-- Copyright Notice -->
                        <div class="text-center mt-3">
                            <small>Video by <a href="https://youtube.com/@lavendaire" target="_blank">Lavendaire</a>. All rights reserved.</small>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Mindfulness Modal -->
        <div class="modal fade" id="mindfulnessModal" tabindex="-1" aria-labelledby="mindfulnessModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-lg">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="mindfulnessModalLabel">Mindfulness Practice</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <div class="ratio ratio-16x9">
                            <iframe src="https://www.youtube.com/embed/mLY-VriCHG8" title="Mindfulness Practice" allowfullscreen></iframe>
                        </div>
                        <!-- Copyright Notice -->
                        <div class="text-center mt-3">
                            <small>Video by <a href="https://www.youtube.com/@GreatMeditation" target="_blank">Great Meditation</a>. All rights reserved.</small>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <section class="third-section">
            <div><h2 class="text-center p-3">Featured Topics</h2></div>
            <div class="home-line"></div>
            <div class="d-flex justify-content-center align-items-center">
                <div class="slider-section container mt-4">
                <div class="slider">
                    <div class="item">
                        <img class="img-fluid" src="assets/home/mental.png" alt="">
                        <h4 class="text-center">Mental well being</h4>
                    </div>
                    <div class="item">
                        <img class="img-fluid" src="assets/home/signs.png" alt="">
                        <h4 class="text-center">Signs & symptoms</h4>
                    </div>
                    <div class="item">
                        <img class="img-fluid"  src="assets/home/burnout.png" alt="">
                        <h4 class="text-center">Burnout</h4>
                    </div>
                    <div class="item">
                        <img class="img-fluid"  src="assets/home/peace.png" alt="">
                        <h4 class="text-center">Peace</h4>
                    </div>
                    <div class="item">
                        <img class="img-fluid" src="assets/home/bed.png" alt="">
                        <h4 class="text-center">Procastination</h4>
                    </div>
                    <button id="prev"><</button>
                    <button id="next">></button>
                </div>
                </div>
            </div>
        </section>

        <section class="fourth-section">
            <div class="text-center pt-3"> <h2>Story Video</h2> </div>
            <div class="home-line"></div>
            <div class="d-flex justify-content-center">
                <video controls>
                <source src="assets/video/Team72.mp4" type="video/mp4">
                Your browser does not support HTML video.
                </video>
            </div>
        </section>

        <section class="chatbot">
            <div class="chatbot-icon">

            <button id="chat-icon" class="chat-btn"> <span>Chat</span>
            </button>
            <!-- <i id="chat-icon" class="bi bi-chat-text"></i>  -->
            </div>

            <div class="chatbox-window">
                <div class="chatbox-header">
                    Chatbox
                </div>
                <div class="chatbox-body" id="chatbox-body">
                    <p>Welcome to the chatbot!</p>
                    <!-- Chat messages will be appended here -->
                </div>
                <form id="chat-form" class="chatbox-form">
                    <div class="input-group">
                        <input type="text" id="chat-input" class="form-control" placeholder="Type your message..." required>
                        <button type="submit" class="btn btn-primary">Send</button>
                    </div>
                </form>
            </div>
        </section>
    </main>

    <!-- footer -->
    <%- include('partials/footer') %>
    <!-- footer end -->


<script>
    let items = document.querySelectorAll('.slider .item');
    let next = document.getElementById('next');
    let prev = document.getElementById('prev');

    let active = 2;
    function loadShow(){
        let stt = 0;
        items[active].style.transform = `none`;
        items[active].style.zIndex = 1;
        items[active].style.filter = 'none';
        items[active].style.opacity = 1;
        for(var i = active + 1; i < items.length; i++){
            stt++;
            items[i].style.transform = `translateX(${120*stt}px) scale(${1 - 0.2*stt}) perspective(16px) rotateY(-1deg)`;
            items[i].style.zIndex = -stt;
            items[i].style.filter = 'blur(5px)';
            items[i].style.opacity = stt > 2 ? 0 : 0.6;
        }
        stt = 0;
        for(var i = active - 1; i >= 0; i--){
            stt++;
            items[i].style.transform = `translateX(${-120*stt}px) scale(${1 - 0.2*stt}) perspective(16px) rotateY(1deg)`;
            items[i].style.zIndex = -stt;
            items[i].style.filter = 'blur(5px)';
            items[i].style.opacity = stt > 2 ? 0 : 0.6;
        }
    }
    loadShow();
    next.onclick = function(){
        active = active + 1 < items.length ? active + 1 : active;
        loadShow();
    }
    prev.onclick = function(){
        active = active - 1 >= 0 ? active - 1 : active;
        loadShow();
    }
</script>
<!-- chatbot script -->

<script>
    const chatbotIcon = document.querySelector('.chatbot-icon');
    const chatboxWindow = document.querySelector('.chatbox-window');
    const chatIcon = document.getElementById('chat-icon');
    const chatboxBody = document.getElementById('chatbox-body');
    const chatForm = document.getElementById('chat-form');
    const chatInput = document.getElementById('chat-input');

    // Toggle chatbox visibility
    chatbotIcon.addEventListener('click', () => {
    const isChatboxVisible = chatboxWindow.style.display === 'block';

    // Toggle chatbox visibility
    chatboxWindow.style.display = isChatboxVisible ? 'none' : 'block';

    // Change the button text or icon
    if (isChatboxVisible) {
        chatIcon.innerHTML = '<span>Chat</span>'; // Change to "Chat"
    } else {
        chatIcon.innerHTML = '<span>X</span>'; // Change to "X"
    }
});

    // Handle chat form submission
// JavaScript function to handle chat form submission
chatForm.addEventListener('submit', async (e) => {
    e.preventDefault();

    const userMessage = chatInput.value.trim();
    if (userMessage === '') return;

    chatboxBody.innerHTML += `<div><strong>You:</strong> ${userMessage}</div>`;
    chatInput.value = '';

    try {
        const response = await fetch('/chatbot/chat', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ message: userMessage }),
        });

        const data = await response.json();
        chatboxBody.innerHTML += `<div><strong>Bot:</strong> ${data.botResponse}</div>`;
    } catch (error) {
        console.error('Error communicating with chatbot:', error);
    }

    chatboxBody.scrollTop = chatboxBody.scrollHeight;
});
</script>

</body>
</html>
